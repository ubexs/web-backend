"use strict";$(document).on("click",".submit-reply",function(a){a.preventDefault(),loading();var b=$(this).attr("data-id"),c=$(".reply-body[data-id=\""+b+"\"]").val(),d=$(".reply-mode-on-ticket[data-id=\"".concat(b,"\"]")).val(),e=$(".hide-reply[data-id=\"".concat(b,"\"]")).val(),f=[];f.push(request("/staff/support/ticket/"+b+"/status","PATCH",{status:d})),c&&f.push(request("/staff/support/ticket/"+b+"/reply","POST",{body:c,visibleToClient:e})),Promise.all(f).then(function(){window.location.reload()})["catch"](function(a){warning(a.responseJSON.message)})}),request("/staff/support/tickets-awaiting-response","GET").then(function(a){if(0===a.length)return $("#tickets").empty().append("<p>Thare are no tickets at this time.</p>");a=a.slice(0,5),$("#tickets").empty();var b=[],c=!0,e=!1,f=void 0;try{for(var g,h,i=a[Symbol.iterator]();!(c=(g=i.next()).done);c=!0)h=g.value,$("#tickets").append("\n        \n        <div class=\"row\">\n            <div class=\"col-12 col-lg-6\">\n                <h1 style=\"font-size:1rem;margin-bottom:0;\">".concat(h.ticketTitle.escape(),"</h1>\n                <p style=\"margin-bottom:1rem;\">").concat(h.ticketBody.escape(),"</p>\n                <p>Created ").concat(moment(h.createdAt).fromNow(),"</p>\n                <p>By: <span data-userid=\"").concat(h.userId,"\">Loading...</span></p>\n                <h1 style=\"font-size:1rem;\">Reply</h1>\n                <textarea class=\"form-control reply-body\" data-id=\"").concat(h.ticketId,"\" rows=\"4\" placeholder=\"Reply Text.\" maxlength=\"4096\"></textarea>\n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <select class=\"form-control hide-reply\" data-id=\"").concat(h.ticketId,"\">\n                            <option value=\"true\">Show Reply to customer</option>\n                            <option value=\"false\">Hide Reply from customer</option>\n                        </select>\n                    </div>\n                    <div class=\"col-8\">\n                        <select class=\"form-control reply-mode-on-ticket\" data-id=\"").concat(h.ticketId,"\">\n                            <option value=\"2\">Require Customer Response</option>\n                            <option value=\"4\">Require More Time</option>\n                            <option value=\"3\">Close</option>\n                        </select>\n                    </div>\n                    <div class=\"col-4\">\n                        <button class=\"btn btn-success submit-reply\" data-id=\"").concat(h.ticketId,"\">Submit</button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-12 col-lg-6\" style=\"height:300px;overflow-y:auto;overflow-x:auto;\">\n                <h1 style=\"font-size:1rem;\">Replies</h1>\n                <div class=\"set-replies\" data-id=\"").concat(h.ticketId,"\">\n                </div>\n            </div>\n            <div class=\"col-12\">\n                <hr />\n            </div>\n        </div>\n        \n        \n        ")),b.push(userId)}catch(a){e=!0,f=a}finally{try{c||null==i["return"]||i["return"]()}finally{if(e)throw f}}setUserNames(b),$(".set-replies").each(function(){var a=this,b=$(this).attr("data-id");request("/staff/support/ticket/"+b+"/replies","GET").then(function(b){if(0===b.length)return $(a).append("<p>There are no replies to this ticket.</p>");var c=[],d=!0,e=!1,f=void 0;try{for(var g,h,i=b[Symbol.iterator]();!(d=(g=i.next()).done);d=!0)h=g.value,c.push(h.userId),$(a).append("\n                \n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <p><span data-userid=\"".concat(h.userId,"\">Loading...</span> - ").concat(moment(h.createdAt).fromNow(),"</p>\n                        <p>").concat(h.ticketBody,"</p>\n                        <hr />\n                    </div>\n                </div>\n                \n                "))}catch(a){e=!0,f=a}finally{try{d||null==i["return"]||i["return"]()}finally{if(e)throw f}}setUserNames(c)})})})["catch"](function(){$("#tickets").empty().append("<p>Thare are no tickets at this time.</p>")}),request("/staff/support/tickets-all","GET").then(function(a){if(0===a.length)return $("#tickets-any-state").empty().append("<p>Thare are no tickets at this time.</p>");a=a.slice(0,5),$("#tickets-any-state").empty();var b=[],c=!0,e=!1,f=void 0;try{for(var g,h,i=a[Symbol.iterator]();!(c=(g=i.next()).done);c=!0)h=g.value,$("#tickets-any-state").append("\n        \n        <div class=\"row\">\n            <div class=\"col-12 col-lg-6\">\n                <h1 style=\"font-size:1rem;margin-bottom:0;\">".concat(h.ticketTitle.escape(),"</h1>\n                <p style=\"margin-bottom:1rem;\">").concat(h.ticketBody.escape(),"</p>\n                <p>Created ").concat(moment(h.createdAt).fromNow(),"</p>\n                <p>By: <span data-userid=\"").concat(h.userId,"\">Loading...</span></p>\n                <h1 style=\"font-size:1rem;\">Reply</h1>\n                <textarea class=\"form-control reply-body\" data-id=\"").concat(h.ticketId,"\" rows=\"4\" placeholder=\"Reply Text.\" maxlength=\"4096\"></textarea>\n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <select class=\"form-control hide-reply\" data-id=\"").concat(h.ticketId,"\">\n                            <option value=\"true\">Show Reply to customer</option>\n                            <option value=\"false\">Hide Reply from customer</option>\n                        </select>\n                    </div>\n                    <div class=\"col-8\">\n                        <select class=\"form-control reply-mode-on-ticket\" data-id=\"").concat(h.ticketId,"\">\n                            <option value=\"2\">Require Customer Response</option>\n                            <option value=\"4\">Require More Time</option>\n                            <option value=\"3\">Close</option>\n                        </select>\n                    </div>\n                    <div class=\"col-4\">\n                        <button class=\"btn btn-success submit-reply\" data-id=\"").concat(h.ticketId,"\">Submit</button>\n                    </div>\n                </div>\n            </div>\n            <div class=\"col-12 col-lg-6\" style=\"height:300px;overflow-y:auto;overflow-x:auto;\">\n                <h1 style=\"font-size:1rem;\">Replies</h1>\n                <div class=\"set-replies-any\" data-id=\"").concat(h.ticketId,"\">\n                </div>\n            </div>\n            <div class=\"col-12\">\n                <hr />\n            </div>\n        </div>\n        \n        \n        ")),b.push(userId)}catch(a){e=!0,f=a}finally{try{c||null==i["return"]||i["return"]()}finally{if(e)throw f}}setUserNames(b),$(".set-replies-any").each(function(){var a=this,b=$(this).attr("data-id");request("/staff/support/ticket/"+b+"/replies","GET").then(function(b){if(0===b.length)return $(a).append("<p>There are no replies to this ticket.</p>");var c=[],d=!0,e=!1,f=void 0;try{for(var g,h,i=b[Symbol.iterator]();!(d=(g=i.next()).done);d=!0)h=g.value,c.push(h.userId),$(a).append("\n                \n                <div class=\"row\">\n                    <div class=\"col-12\">\n                        <p><span data-userid=\"".concat(h.userId,"\">Loading...</span> - ").concat(moment(h.createdAt).fromNow(),"</p>\n                        <p>").concat(h.ticketBody,"</p>\n                        <hr />\n                    </div>\n                </div>\n                \n                "))}catch(a){e=!0,f=a}finally{try{d||null==i["return"]||i["return"]()}finally{if(e)throw f}}setUserNames(c)})})})["catch"](function(){$("#tickets-any-state").empty().append("<p>Thare are no tickets at this time.</p>")});






































